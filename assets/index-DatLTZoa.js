(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))d(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const p of i.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&d(p)}).observe(document,{childList:!0,subtree:!0});function c(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function d(r){if(r.ep)return;r.ep=!0;const i=c(r);fetch(r.href,i)}})();const P=(e,t=document)=>{const c=Array.from(t.querySelectorAll(e));if(!c)throw new Error(`Element not found: ${e}`);return c},l=(e,t=document)=>{const c=t==null?void 0:t.querySelector(e);if(!c)throw new Error(`Element not found: ${e}`);return c},J=e=>({getJson:async d=>(e(!0),window.fetch(d).then(r=>r.json()).then(async r=>(e(!1),r)).catch(()=>null)||null),getText:async d=>(e(!0),window.fetch(d).then(r=>r.text()).then(async r=>(e(!1),r)).catch(()=>null)||null)}),K=(e,t)=>Math.floor(Math.random()*(t-e)+e),z=e=>{const{getText:t,getJson:c}=J(e),d=[];return{loadWords:async()=>{const m=await t("https://iambrian.com/sordle-words/5-letter-words.txt");m&&d.push(...m.split(`
`))},getRandomWord:async()=>{const m=d[K(0,7435)];return(await c("https://iambrian.com/sordle-words/5-letter-words/"+m+".json"))[0]},checkWord:m=>d.includes(m)}},S=async e=>await new Promise(t=>{setTimeout(()=>{t()},e)}),_=async()=>await new Promise(e=>{requestAnimationFrame(()=>{const t=new MessageChannel;t.port1.onmessage=e,t.port2.postMessage(void 0)})});function G(){const e=l(".notify");let t;const c=()=>{e.style.opacity="0",t=setTimeout(()=>{e.innerHTML=""},200)};return{notify:(r,i=!0)=>{t&&clearTimeout(t),e.innerHTML=r,setTimeout(()=>{e.style.opacity="1"},1),i&&(t=setTimeout(()=>{c()},1500))},hideNotify:c}}const j=6,y=5;function X(){const e=l(".app"),t=l(".overlay"),c=l("main"),d=l("main").innerHTML,r={welcome:l('[data-template="modal-welcome"]').innerHTML,success:l('[data-template="modal-success"]').innerHTML,fail:l('[data-template="modal-fail"]').innerHTML};t.innerHTML=r.welcome;let i,p=!0;const m=n=>{n!==p&&(p=n,n&&e.classList.add("loading"),i&&clearInterval(i),i=setTimeout(()=>{if(!p){e.classList.remove("loading");return}m(!0)},2e3))},{checkWord:H,getRandomWord:C,loadWords:A}=z(m);A().then(()=>E());const{hideNotify:F,notify:W}=G();let h,g=[],k;const v={};let $=()=>P(`main .attempt:nth-child(${a.index+1}) .char`);const R=async(n,o)=>{F(),g=n,h=o,c.innerHTML=d,k=l(".attempts",c);let s="";for(let u=0;u<j;u++){s+='<div class="attempt">';for(let f=0;f<y;f++)s+=`<div class="char" id="char-${u}-${f}"><div class="front"></div><div class="back"></div></div>`;s+="</div>"}k.innerHTML=s,await _(),T({index:0,chars:[]}),setTimeout(()=>{P("[data-key]",c).forEach(u=>{u.dataset.key&&(v[u.dataset.key]=u)})},10)};let a={chars:[],index:0};const N=n=>{const o=l(`#char-${a.index}-${a.chars.length}`);l(".front",o).innerText=n||"",l(".back",o).innerText=n||""},T=n=>{a=n};let L=!1;const q=async(n=300)=>{L=!0,await Promise.all([...$().map(async(o,s)=>{await S(n*s),o.classList.add("flip")}),await S(n*(y+2))]),L=!1};let M;const x=(n="cell")=>{M&&clearTimeout(M);let o=$();n!=="row"&&(o=[o[0]]),o.forEach(s=>s.classList.add("horizontal-shake")),M=setTimeout(()=>{o.forEach(s=>s.classList.remove("horizontal-shake"))},500)},E=async()=>{const n=await C();return R(n.word.split(""),n)},b=()=>{h!=null&&h.meanings&&setTimeout(()=>{l("[data-definition]",t).innerHTML=`<h3>${g.join("")}</h3>
<ul class="meanings">
    ${h==null?void 0:h.meanings.map(n=>{var o;return`    
    <li>
        <p class="part-of-speech"><span>${n.partOfSpeech}</span></p>
        <ol>
            ${(o=n.definitions)==null?void 0:o.map(s=>`
            <li>
                <p>${s.definition}</p>
                ${s.example?`<p class="example">"${s.example}"</p>`:""}
            </li>`).join("")}
        </ol>
    </li>`}).join("")}
</ul>`},1)},D=async()=>{if(a.chars.length<y){x(),W("Not enough letters");return}if(!await H(a.chars.join(""))){x("row"),W("Not in word list");return}let o=0;const s={},u=$();a.chars.forEach((f,w)=>{g[w]===f?(s[f]="green",u[w].classList.add("green"),o++):g.includes(f)?(s[f]=s[f]||"yellow",u[w].classList.add("yellow")):s[f]=s[f]||"none"}),await q(),Object.entries(s).forEach(([f,w])=>{v[f].classList.add(w)}),o===y?(t.innerHTML=r.success,setTimeout(()=>{l("[data-attempt-text]",t).innerText=` ${a.index} ${a.index?"attempts":"attempt"}`},1),b(),E()):a.index+1===j&&(t.innerHTML=r.fail,b(),E()),T({chars:[],index:a.index+1})},O=n=>{if(!L&&v[n]){if(n==="backspace"){a.chars.length?(a.chars.pop(),N(""),T(a)):x();return}if(n==="enter"){D();return}a.chars.length===y&&a.chars.pop(),N(n),a.chars.push(n),T(a)}},I=async n=>{if(L)return;const o=n.target;if(o.nodeName.toLowerCase()==="a")return;if(n.preventDefault(),o.blur(),o.nodeName.toLowerCase()==="h1"){t.innerHTML=r.welcome;return}if(o.dataset.action==="closeModal"){t.innerHTML="";return}const s=o.dataset.key;s&&O(s)};e.addEventListener("click",I),t.addEventListener("click",()=>{t.innerHTML=""}),window.addEventListener("keyup",n=>O(n.key.toLowerCase()))}X();const B=async()=>{if("serviceWorker"in navigator)try{const e=await navigator.serviceWorker.register("/sw.js",{scope:"/"});e.installing?console.info("Service worker installing"):e.waiting?console.info("Service worker installed"):e.active&&console.info("Service worker active")}catch(e){console.error(`Registration failed with ${e}`)}};B();
