(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))d(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const p of a.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&d(p)}).observe(document,{childList:!0,subtree:!0});function c(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function d(r){if(r.ep)return;r.ep=!0;const a=c(r);fetch(r.href,a)}})();const P=(n,e=document)=>{const c=Array.from(e.querySelectorAll(n));if(!c)throw new Error(`Element not found: ${n}`);return c},l=(n,e=document)=>{const c=e==null?void 0:e.querySelector(n);if(!c)throw new Error(`Element not found: ${n}`);return c},J=n=>({getJson:async d=>(n(!0),window.fetch(d).then(r=>r.json()).then(async r=>(n(!1),r)).catch(()=>null)||null),getText:async d=>(n(!0),window.fetch(d).then(r=>r.text()).then(async r=>(n(!1),r)).catch(()=>null)||null)}),K=(n,e)=>Math.floor(Math.random()*(e-n)+n),z=n=>{const{getText:e,getJson:c}=J(n),d=[];return{loadWords:async()=>{const m=await e("https://iambrian.com/sordle-words/5-letter-words.txt");m&&d.push(...m.split(`
`))},getRandomWord:async()=>{const m=d[K(0,7435)];return(await c("https://iambrian.com/sordle-words/5-letter-words/"+m+".json"))[0]},checkWord:m=>d.includes(m)}},j=async n=>await new Promise(e=>{setTimeout(()=>{e()},n)}),_=async()=>await new Promise(n=>{requestAnimationFrame(()=>{const e=new MessageChannel;e.port1.onmessage=n,e.port2.postMessage(void 0)})});function G(){const n=l(".notify");let e;const c=()=>{n.style.opacity="0",e=setTimeout(()=>{n.innerHTML=""},200)};return{notify:(r,a=!0)=>{e&&clearTimeout(e),n.innerHTML=r,setTimeout(()=>{n.style.opacity="1"},1),a&&(e=setTimeout(()=>{c()},1500))},hideNotify:c}}const C=6,y=5;(async()=>{const n=l(".app"),e=l(".overlay"),c=l("main"),d=l("main").innerHTML,r={welcome:l('[data-template="modal-welcome"]').innerHTML,success:l('[data-template="modal-success"]').innerHTML,fail:l('[data-template="modal-fail"]').innerHTML};e.innerHTML=r.welcome;let a,p=!0;const m=t=>{t!==p&&(p=t,t&&n.classList.add("loading"),a&&clearInterval(a),a=setTimeout(()=>{if(!p){n.classList.remove("loading");return}m(!0)},2e3))},{checkWord:H,getRandomWord:A,loadWords:F}=z(m);F().then(()=>x());const{hideNotify:S,notify:W}=G();let h,T=[],k;const v={};let $=()=>P(`main .attempt:nth-child(${i.index+1}) .char`);const q=async(t,o)=>{S(),T=t,h=o,c.innerHTML=d,k=l(".attempts",c);let s="";for(let f=0;f<C;f++){s+='<div class="attempt">';for(let u=0;u<y;u++)s+=`<div class="char" id="char-${f}-${u}"><div class="front"></div><div class="back"></div></div>`;s+="</div>"}k.innerHTML=s,await _(),g({index:0,chars:[]}),setTimeout(()=>{P("[data-key]",c).forEach(f=>{f.dataset.key&&(v[f.dataset.key]=f)})},10)};let i={chars:[],index:0};const N=t=>{const o=l(`#char-${i.index}-${i.chars.length}`);l(".front",o).innerText=t||"",l(".back",o).innerText=t||""},g=t=>{i=t};let L=!1;const R=async(t=300)=>{L=!0,await Promise.all([...$().map(async(o,s)=>{await j(t*s),o.classList.add("flip")}),await j(t*(y+2))]),L=!1};let E;const M=(t="cell")=>{E&&clearTimeout(E);let o=$();t!=="row"&&(o=[o[0]]),o.forEach(s=>s.classList.add("horizontal-shake")),E=setTimeout(()=>{o.forEach(s=>s.classList.remove("horizontal-shake"))},500)},x=async()=>{const t=await A();return q(t.word.split(""),t)},b=()=>{h!=null&&h.meanings&&setTimeout(()=>{l("[data-definition]",e).innerHTML=`<h3>${T.join("")}</h3>
<ul class="meanings">
    ${h==null?void 0:h.meanings.map(t=>{var o;return`    
    <li>
        <p class="part-of-speech"><span>${t.partOfSpeech}</span></p>
        <ol>
            ${(o=t.definitions)==null?void 0:o.map(s=>`
            <li>
                <p>${s.definition}</p>
                ${s.example?`<p class="example">"${s.example}"</p>`:""}
            </li>`).join("")}
        </ol>
    </li>`}).join("")}
</ul>`},1)},D=async()=>{if(i.chars.length<y){M(),W("Not enough letters");return}if(!await H(i.chars.join(""))){M("row"),W("Not in word list");return}let o=0;const s={},f=$();i.chars.forEach((u,w)=>{T[w]===u?(s[u]="green",f[w].classList.add("green"),o++):T.includes(u)?(s[u]=s[u]||"yellow",f[w].classList.add("yellow")):s[u]=s[u]||"none"}),await R(),Object.entries(s).forEach(([u,w])=>{v[u].classList.add(w)}),o===y?(e.innerHTML=r.success,setTimeout(()=>{l("[data-attempt-text]",e).innerText=` ${i.index} ${i.index?"attempts":"attempt"}`},1),b(),x()):i.index+1===C&&(e.innerHTML=r.fail,b(),x()),g({chars:[],index:i.index+1})},O=t=>{if(!L&&v[t]){if(t==="backspace"){i.chars.length?(i.chars.pop(),N(""),g(i)):M();return}if(t==="enter"){D();return}i.chars.length===y&&i.chars.pop(),N(t),i.chars.push(t),g(i)}},I=async t=>{if(L)return;const o=t.target;if(o.nodeName.toLowerCase()==="a")return;if(t.preventDefault(),o.blur(),o.nodeName.toLowerCase()==="h1"){e.innerHTML=r.welcome;return}if(o.dataset.action==="closeModal"){e.innerHTML="";return}const s=o.dataset.key;s&&O(s)};n.addEventListener("click",I),e.addEventListener("click",()=>{e.innerHTML=""}),window.addEventListener("keyup",t=>O(t.key.toLowerCase()))})();"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/serviceWorker.js").then(()=>console.info("service worker registered")).catch(n=>console.info("service worker not registered",n))});
